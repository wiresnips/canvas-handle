var CanvasHandle=function(){function j(e,f,c){e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c)}function k(e,f){var c=e.getBoundingClientRect();return[f.clientX-c.left,f.clientY-c.top]}function g(e,f,c){function g(b){if(a.disabled)return h(null);a.mouseDownPos=k(e,b);a.deltaPos=[a.mouseDownPos[0]-a.pos[0],a.mouseDownPos[1]-a.pos[1]];a.pos=a.mouseDownPos;null!=a.move&&a.move()}function h(){null!=a.drop&&a.drop();var b=window,d=g;b.removeEventListener?b.removeEventListener("mousemove",
d,!1):b.detachEvent&&b.detachEvent("onmousemove",d);b=window;d=h;b.removeEventListener?b.removeEventListener("mouseup",d,!1):b.detachEvent&&b.detachEvent("onmouseup",d);a.unlock()}var l=c*c;this.pos=f;this.deltaPos=[0,0];this.drop=this.move=this.grab=this.mouseDownPos=null;this.disabled=!1;var a=this;j(e,"mousedown",function(b){if(!a.disabled&&!a.isLocked()){b=k(e,b);var d=a.pos,c=d[0]-b[0],d=d[1]-b[1];c*c+d*d>l||(a.lock(),a.mouseDownPos=b,null!=a.grab&&a.grab(),j(window,"mousemove",g),j(window,"mouseup",
h))}})}var h=!1;g.prototype.isLocked=function(){return h};g.prototype.lock=function(){h=!0};g.prototype.unlock=function(){h=!1};return g}();